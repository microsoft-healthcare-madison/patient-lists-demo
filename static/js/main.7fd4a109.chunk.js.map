{"version":3,"sources":["components/HeaderPanel.js","api.js","components/FHIRResource.js","components/ListsPanel.js","components/DeveloperPanel.js","components/PatientsPanel.js","components/AttributesPanel.js","App.js","serviceWorker.js","index.js"],"names":["ServerInputForm","props","React","useState","serverRootURL","setServerRootURL","validURL","setValidURL","tagSystem","setTagSystem","tagCode","setTagCode","isSettingsOpen","setIsSettingsOpen","showPassword","setShowPassword","token","setToken","lockButton","content","icon","minimal","onClick","isOpen","keepChildrenMounted","className","onSubmit","event","preventDefault","setBearerToken","type","value","onChange","target","trim","URL","fetch","then","catch","e","placeholder","rightElement","onInput","disabled","HeaderPanel","bearerToken","this","developerMessages","setDeveloperMessages","Component","getRefsFrom","bundle","code","resources","entry","map","resource","filter","Boolean","getResources","ch7istics","flatMap","x","characteristic","coding","some","c","system","getCharacteristics","locations","Set","valueReference","reference","sort","resourceUrl","progressCallback","a","bundles","url","authorization","headers","Authorization","undefined","response","json","push","newBundle","pop","next","link","relation","length","total","filterLists","lists","selections","listsCopy","console","warn","b","left","name","right","localeCompare","Resource","resourceType","id","display","getHoverData","hoverContent","attribute","key","style","fontWeight","transitionDuration","intent","boundary","hoverCloseDelay","enforceFocus","ListSelector","selectedList","setSelectedList","handleListSelection","selectedValue","href","encodeURI","color","rel","actual","member","ResourceRow","ListsPanel","state","groups","groupsIncluded","locationsIncluded","serverRoot","bind","loaded","includes","params","encodedParamString","kv","encodeURIComponent","join","query","stateLocation","validator","drain","getRefreshQueryUrl","newState","included","setState","setPatients","refreshResources","refreshData","list","cachedPatients","members","memberRefs","entity","log","r","has","resolvePatients","overflowY","DeveloperPanel","messages","isHidden","setIsHidden","zIndex","position","title","patientAttributeGetters","p","patient","officialNames","use","names","given","fn","family","replace","ageMs","Date","now","parse","birthDate","Math","trunc","getUTCFullYear","gender","PatientsPanel","patients","attributeGetters","getters","extraAttributeGetters","columns","condensed","interactive","slice","getter","getRow","row","col","i","ExtraAttributesPanel","what","setColumns","setExtraAttributeGetters","checked","handleAttributeSelected","isChecked","App","useEffect","message","d","window","location","hostname","match","DemoApp","strict","StrictMode","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister","error"],"mappings":"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","file":"static/js/main.7fd4a109.chunk.js","sourcesContent":["import React from 'react';\nimport 'components/HeaderPanel.css'\nimport { Button, Collapse, InputGroup, Tooltip } from \"@blueprintjs/core\";\n\nconst appTitle = \"Patient Lists Demo App\";\n\n// NICE: Remake this as a NavBar: https://blueprintjs.com/docs/#core/components/navbar\n//       The Server Root URL can be part of a Settings Cog, then.\n\n// EASY: add a blueprint Toast when a server entry has been entered and accpeted:\n//       https://blueprintjs.com/docs/#core/components/toast\n\nfunction ServerInputForm(props) {\n  const [serverRootURL, setServerRootURL] = React.useState(props.serverRootURL);\n  const [validURL, setValidURL] = React.useState(true);\n  const [tagSystem, setTagSystem] = React.useState(props.tagSystem);\n  const [tagCode, setTagCode] = React.useState(props.tagCode)\n  const [isSettingsOpen, setIsSettingsOpen] = React.useState(false);\n  const [showPassword, setShowPassword] = React.useState(false);\n  const [token, setToken] = React.useState('');\n\n  const applySettingsButton = (event) => {\n    event.preventDefault();\n    props.setServerRootURL(serverRootURL);\n    props.setTagCode(tagCode);\n    props.setTagSystem(tagSystem);\n    props.setBearerToken(token);\n  }\n\n  // Updates the input field value as the user enters new values.\n  const serverRootChanged = (event) => {\n    const value = event.target.value.trim();\n    setServerRootURL(value);\n    try {\n      new URL(value);\n      fetch(value + '/metadata')\n        .then(() => setValidURL(true))\n        .catch(() => setValidURL(false));\n    } catch(e) {\n      setValidURL(false);\n    }\n  }\n\n  // Updates the input field as the user enters new values.\n  const tagSystemChanged = (event) => {\n    setTagSystem(event.target.value.trim());\n  }\n\n  // Updates the input field as the user enters new values.\n  const tagCodeChanged = (event) => {\n    setTagCode(event.target.value.trim());\n  }\n\n  const lockButton = (\n    <Tooltip content={`${showPassword ? \"Hide\" : \"Show\"} Password`}>\n      <Button\n        icon={showPassword ? \"unlock\" : \"lock\"}\n        minimal={true}\n        onClick={() => setShowPassword(!showPassword)}\n      />\n    </Tooltip>\n  );\n\n  const tokenInput = (event) => {\n    setToken(event.target.value);\n  }\n\n  // TODO: replace this homebrewed form with a blueprint FormGroup, maybe.\n  return (\n    <>\n      <Button\n        onClick={ () => { setIsSettingsOpen(!isSettingsOpen); } }\n      >{ isSettingsOpen ? \"Hide\" : \"Show\" } Settings</Button>\n      <Collapse\n        isOpen={isSettingsOpen}\n        keepChildrenMounted={true}\n      >\n        <form className=\"server\" onSubmit={applySettingsButton}>\n          <label>FHIR Server Root</label>\n          &nbsp;\n          <input\n            className=\"url\"\n            type=\"text\"\n            value={serverRootURL}\n            onChange={serverRootChanged}\n          />\n          <br></br>\n          <br></br>\n\n          <label>Authentication</label>\n          <table>\n            <tbody>\n              <tr><td>Bearer Token</td></tr>\n              <tr><td>\n                <InputGroup\n                  placeholder=\"Enter a bearer token...\"\n                  rightElement={lockButton}\n                  type={showPassword ? \"text\" : \"password\"}\n                  onInput={tokenInput}\n                />\n              </td></tr>\n            </tbody>\n          </table>\n          <br></br>\n          <br></br>\n\n          <label>Data Tag</label>\n          <table>\n            <tbody>\n              <tr>\n                <td>\n                  <label>system</label>\n                </td>\n                <td>\n                  <input\n                    className=\"url\"\n                    type=\"text\"\n                    value={tagSystem}\n                    onChange={tagSystemChanged}\n                  />\n                </td>\n              </tr>\n              <tr>\n                <td>\n                  <label>code</label>\n                </td>\n                <td>\n                  <input\n                    type=\"text\"\n                    value={tagCode}\n                    onChange={tagCodeChanged}\n                  />\n                </td>\n              </tr>\n            </tbody>\n          </table>\n          <Button type=\"submit\" disabled={!validURL}>Apply</Button>\n        </form>\n      </Collapse>\n    </>\n  );\n}\n\nclass HeaderPanel extends React.Component {\n  render() {\n    return (\n      <div>\n        <span className=\"app-title\">{appTitle}</span>\n        <ServerInputForm\n          bearerToken={this.props.bearerToken}\n          developerMessages={this.props.developerMessages}\n          serverRootURL={this.props.serverRootURL}\n          setBearerToken={this.props.setBearerToken}\n          setDeveloperMessages={this.props.setDeveloperMessages}\n          setServerRootURL={this.props.setServerRootURL}\n          setTagCode={this.props.setTagCode}\n          setTagSystem={this.props.setTagSystem}\n          tagCode={this.props.tagCode}\n          tagSystem={this.props.tagSystem}\n      />\n      </div>  \n    );\n  }\n}\n\nexport default HeaderPanel;\n","// TODO: consider renaming this file\n\nexport const codeSystem = \"http://argonautproject.org/patient-lists/CodeSystem/characteristics\";\nexport const demoTag = {\n  system: 'http://connectathon.fhir.org/',\n  code: '2020-sep',\n};\n\n\n// Returns the non-empty resources from a bundle.\nfunction getResources(bundle) {\n  return bundle && bundle.entry ? bundle.entry.map(e => e.resource).filter(Boolean) : [];\n}\n\n// Returns the patient list characteristics matching a code (ie 'at-location').\nfunction getCharacteristics(resources, code) {\n  const hasChars = resources.flatMap(x => x.characteristic).filter(Boolean);\n  return hasChars.filter(\n    x => x.code && x.code.coding && x.code.coding.some(\n      c => c.system === codeSystem && c.code === code\n    )\n  );\n}\n\n// Returns the sorted set of code references from lists in a bundle.\nexport function getRefsFrom(bundle, code) {\n  const resources = getResources(bundle);\n  if (!resources) {\n    return [];\n  }\n  const ch7istics = getCharacteristics(resources, code);\n  const locations = new Set(ch7istics.map(x => x.valueReference.reference));\n  return [...locations].sort();\n}\n\n// NICE: When the results include resources of different types, there should be\n//       separate bundles per type.  So, if the first pages of bundles contain\n//       Group followed by pages of Patient bundles - the returned value should be\n//       a list of 2 bundles with all the Groups and Patients separated.\n\n// NICE: Don't return a Bundle.  Instead return a list of tuples: [[ResourceType, [resources]], ...]\n\n// Returns a de-paginated bundle of resources from an initial URL.\nexport async function drain(resourceUrl, bearerToken, progressCallback) {\n  const bundles = [];\n  let url = resourceUrl;\n  const authorization = {\n    headers: {\n      Authorization: `Bearer ${bearerToken}`\n    }\n  }\n  do {\n    // Fetch a bundle from the URL.\n    await fetch(url, bearerToken ? authorization : undefined)\n      .then(response => response.json())\n      .then(bundle => bundles.push(bundle));\n    const newBundle = bundles.pop();\n    if (!newBundle.entry) { newBundle.entry = []; }\n\n    // If the search was paginated, prepare to fetch the following bundle.\n    const next = newBundle.link.filter(x => x.relation === 'next');\n    url = next.length ? next[0].url : undefined;\n\n    // Build up the entries in the first bundle to include entries from all.\n    if (bundles.length === 0) {\n      bundles.push(newBundle);\n    } else {\n      bundles[0].entry.push(...newBundle.entry);\n    }\n\n    // Inform the caller of the current progress via callback, if defined.\n    if (progressCallback && bundles.length && bundles[0].entry) {\n      progressCallback(bundles[0].entry.length, bundles[0].total);\n    }\n  } while (url);\n  return bundles[0];\n}\n\n// Returns a list of resources from a bundle based on in-app selections.\nexport function filterLists(lists, selections) {\n  // Shallow-copy the list.\n  const listsCopy = [...lists];\n\n  // TODO: apply the filter by removing lists that match no selections.\n  if (selections.length) {\n    console.warn('Not Implemented yet: api.filterLists', selections);  // XXX\n  }\n\n  // Sort the remaining lists by name.\n  return listsCopy.sort((a, b) => {\n    const left = a.resource.name || '';\n    const right = b.resource.name || '';\n    return left.localeCompare(right);\n  });\n}\n","/*\n  A component that wraps a FHIR resource, enabling a hover-text popup with\n  additional details about the resource.\n\n  <Resource\n    resource={resource}\n    display={resource.name}\n    getHoverData={(resource) => {\n      return [\n        ['id', resource.id],\n        ['url', resource.url],\n        ['name', resource.name],\n      ];\n    }}\n    />\n  \n  NICE\n    [ ] hover-text shows extra details in a *focusable* pop-up panel\n*/\nimport React from 'react'\nimport { Tooltip } from \"@blueprintjs/core\";\n\nexport function Resource(props) {\n  const resource = props.resource;\n  const reference = `${resource.resourceType}/${resource.id}`\n  const display = props.display || reference;\n  const disabled = props.getHoverData ? false : true;\n  let hoverContent = <table/>;  // placeholder\n  if (props.getHoverData) {\n    hoverContent = (\n      <table>\n        <tbody>\n          {\n            props.getHoverData(resource).map(([attribute, value]) => {\n              return (\n                <tr key={`${reference}.${attribute}`}>\n                  <td style={{fontWeight: 'bold'}}>{attribute}</td>\n                  <td>{value}</td>\n                </tr>\n              );\n            })\n          }\n        </tbody>\n      </table>\n    );\n  }\n  // TODO: figure out how to enable the tool-top to be focused when hovered-over.\n  return (\n    <Tooltip\n      content={hoverContent}\n      disabled={disabled}\n      transitionDuration={100}\n      intent=\"primary\"\n      boundary=\"viewport\"\n      hoverCloseDelay={1000}\n      enforceFocus={false}\n    >\n      <span>{display}</span>\n    </Tooltip>\n  );\n}\n","import { drain, getRefsFrom, filterLists } from 'api';\nimport React from 'react';\nimport { Radio, RadioGroup } from \"@blueprintjs/core\";\nimport { Resource } from 'components/FHIRResource';\n\nconst debug = false;  // XXX\n\n// TODO: move this to a FHIRGroup module?\n// TODO: create a src.components.fhir folder?\n\n// A FHIR Resource in a table row.\nfunction ResourceRow(props) {\n  const resource = props.resource;\n  const key = `${resource.resourceType}/${resource.id}`;\n  return (\n    <Radio\n      key={key}\n      value={key}\n    >\n      <Resource\n        display={resource.name}\n        resource={resource}\n        getHoverData={(resource) => {\n          return [\n            ['reference', (\n              <a\n                href={encodeURI(`${props.serverRootURL}/${key}`)}\n                style={{color: 'yellow'}}\n                rel=\"noopener noreferrer\"\n                target=\"_blank\"\n              >\n                {key}\n              </a>\n            )],\n            ['actual', resource.actual ? 'true' : 'false'],\n            ['type', resource.type],\n            ['members', resource.member ? resource.member.length : 0],\n            // TODO: add any other relevant hover-text fields here.\n          ];\n        }}\n      />\n    </Radio>\n  );\n}\n\n// A sorted list of patient lists, pre-filtered by the current filter selection.\nfunction ListSelector(props) {\n  // TODO: pull this up to the main panel.\n  const [selectedList, setSelectedList] = React.useState();\n  if (!props.lists) {\n    return <></>;\n  }\n\n  function getList(reference) {\n    return props.lists.filter(\n      (x) => `Group/${x.resource.id}` === reference\n    )[0];\n  }\n\n  return (\n    <RadioGroup\n      onChange={(e) => {\n        setSelectedList(e.target.value);\n        props.handleListSelection(getList(e.target.value).resource);\n      }}\n      selectedValue={selectedList}\n    >{\n        props.lists.map((x) => {\n          return ResourceRow({\n            handleListSelection: props.handleListSelection,\n            resource: x.resource,\n            serverRootURL: props.serverRootURL,\n          });\n        })\n      }\n    </RadioGroup>\n  );\n}\n\n// A panel of selectable patient lists with optional filters.\nclass ListsPanel extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      groups: [],\n      groupsIncluded: [],\n      locations: [],\n      locationsIncluded: [],\n      serverRoot: props.serverRootURL,\n      bearerToken: props.bearerToken,\n      tagCode: props.tagCode,\n      tagSystem: props.tagSystem,\n    };\n    this.handleListSelection = this.handleListSelection.bind(this);\n  }\n\n  // NICE: update something on-screen while data is loading.\n  progressCallback(resourceType, loaded, total) {\n    if (debug) {\n      console.log(`Loaded ${loaded} of ${total} ${resourceType} records`);\n    }\n  }\n\n  // Returns a URL to refresh an optionally tagged resource type which may _include other types.\n  getRefreshQueryUrl(resourceType, includes) {\n    const params = [];\n    if (this.props.tagSystem && this.props.tagCode) {\n      params.push(['_tag', `${this.props.tagSystem}|${this.props.tagCode}`]);\n    }\n    if (includes && includes.length) {\n      params.push(...includes.map(x => ['_include', x]));\n    }\n    const encodedParamString = params\n      .map(kv => kv.map(encodeURIComponent).join(\"=\"))\n      .join(\"&\");\n    const query = encodedParamString ? `?${encodedParamString}` : '';\n    return `${this.props.serverRootURL}/${resourceType}${query}`;\n  }\n\n  refreshResources(resourceType, stateLocation, includes, validator) {\n    const url = this.getRefreshQueryUrl(resourceType, includes);\n    drain(url, this.props.bearerToken, (x, total) => { this.progressCallback(resourceType, x, total); })\n      .then((bundle) => {\n        const newState = {};\n        const resources = bundle.entry.filter(e => e.resource.resourceType === resourceType);\n        const included = bundle.entry.filter(e => e.resource.resourceType !== resourceType);\n        newState[stateLocation] = resources;\n        newState[`${stateLocation}Included`] = included;\n        if (validator) {\n          resources.map(x => validator(resourceType, x));\n        }\n        this.setState(newState);\n      });\n  }\n\n  refreshData() {\n    this.props.setPatients([]);\n    //this.props.setSelectedList(undefined);\n    this.refreshResources('Group', 'groups', ['Group:member']);\n    this.refreshResources('Location', 'locations');\n    // NICE: examine the fetched data, logging a warning to DeveloperPanel if any look malformed\n  }\n\n  componentDidMount() {\n    this.refreshData();\n  }\n\n  componentDidUpdate() {\n    // Refresh ALL the cached data when the server component has changed.\n    const needsRefresh =\n      (this.state.serverRoot !== this.props.serverRootURL) ||\n      (this.state.bearerToken !== this.props.bearerToken) ||\n      (this.state.tagCode !== this.props.tagCode) ||\n      (this.state.tagSystem !== this.props.tagSystem);\n\n    if (needsRefresh) {\n      this.refreshData();\n      this.setState({\n        serverRoot: this.props.serverRootURL,\n        bearerToken: this.props.bearerToken,\n        tagCode: this.props.tagCode,\n        tagSystem: this.props.tagSystem,\n      });\n    }\n  }\n\n  // BUG: This app assumes that a Group's member.entity contains a 'reference' to a patient.\n  //      The 'reference' member.entity attribute is technically optional - there are other\n  //      ways to represent a reference to a list member.\n  //      Maybe a validator can log a warning about that earlier in the UI when encountered\n  //      (and fail gracefully).\n\n  // TODO: move this logic to the api.js module, since it has nothing to do with rendering and\n  //       everything to do with the new API.\n\n  // TODO: include the FHIR server root URL in case it's needed to fetch a patient that's not\n  //       in the cache already.\n\n  // Returns the complete list of Patient resources who are members of a list.\n  resolvePatients(list, cachedPatients) {\n\n    // Returns the reference for a list member from the list.member fragment.\n    function getReference(member) {\n      if (member && member.entity) {\n        return member.entity.reference;\n      }\n      console.log('resolvePatients.getReference: unknown reference type in:', list);\n    }\n\n    const members = list.member ? list.member : [];\n    const memberRefs = new Set(members.map(getReference).filter(x => x));\n\n    // NICE: if the member is not in the cache, log a warning somewhere, or maybe fetch it.\n\n    return cachedPatients\n      .map(x => x.resource)\n      .filter(r => memberRefs.has(`${r.resourceType}/${r.id}`)\n    );\n  }\n\n  handleListSelection(resource) {\n    if (!resource.member) {\n      this.props.setPatients([]);\n    } else {\n      this.props.setPatients(\n        this.resolvePatients(resource, this.state.groupsIncluded)\n      );\n    }\n  }\n\n  render() {\n    const lists = this.state.groups;\n    // TODO: group the characteristics selections into one function.\n    const locations = getRefsFrom(lists, 'at-location');\n    const orgs = getRefsFrom(lists, 'attributed-to-organization');\n    const docs = getRefsFrom(lists, 'attributed-to-practitioner');\n    const careTeams = getRefsFrom(lists, 'attributed-to-careteam');\n    // TODO: get the component selections, saving them into an object.\n    // TODO: also collect Orgs and Docs from the ManagingEntity field (either should work).\n    if (debug) {\n      console.log('render selections from', locations, orgs, docs, careTeams);  // XXX\n    }\n    const selections = [];\n\n    // TODO: pass in a hook state for the selectedList and a setter.  This will allow a data refresh to\n    //       un-select the current selected list (which would be needed when changing servers).\n\n    // NICE: turn this into a NavBar: https://blueprintjs.com/docs/#core/components/navbar followed by a scrollable ListSelector\n    return (\n      <>\n        <div style={{ fontWeight: 'bold' }} >\n          Patient Lists ({this.state.groups.length})\n        </div>\n        <div style={{ overflowY: 'scroll' }} >\n          <ListSelector\n            handleListSelection={this.handleListSelection}\n            lists={filterLists(lists, selections)}\n            serverRootURL={this.props.serverRootURL}\n            bearerToken={this.props.bearerToken}\n          />\n        </div>\n      </>\n    );\n  }\n}\n\nexport default ListsPanel;","import React from 'react';\nimport 'components/DeveloperPanel.css'\nimport { Button, Callout, Collapse } from \"@blueprintjs/core\";\n\n// NICE: enable this panel to be resized up and down.\n\nexport default function DeveloperPanel(props) {\n  let messages = props.developerMessages || <pre key=\"0\">None</pre>;\n  const [isHidden, setIsHidden] = React.useState(true);\n\n  return (\n    <>\n      <Button\n        onClick={() => {setIsHidden(!isHidden)}}\n        style={{zIndex: 1, position: 'relative'}}\n      >\n        {isHidden ? \"Show\" : \"Hide\"} Developer Messages\n      </Button>\n      <Collapse isOpen={!isHidden}>\n        <Callout title=\"Developer Messages (Most Recent At Top)\">\n          <div style={{overflowY: 'scroll'}}>\n            {messages}\n          </div>\n        </Callout>\n      </Collapse>\n    </>\n  );\n}\n","import React from 'react';\nimport 'components/PatientsPanel.css'\nimport { HTMLTable } from '@blueprintjs/core';\n\n// TODO: decide how to enable the on-hover data for patients, just like in the lists panel\n\nfunction getRow(patient, attributeGetters) {\n  return attributeGetters.map(getter => getter[1](patient));\n}\n\nfunction getData(patients, attributeGetters) {\n  return patients.map(patient => getRow(patient, attributeGetters));\n}\n\nfunction getName(patient) {\n  if (patient && patient.name) {\n    const officialNames = patient.name.filter(name => name.use === 'official');\n    if (officialNames.length) {\n      const name = officialNames[0];\n      const names = name.given.map(fn => `${fn} ${name.family}`);\n      if (names.length) {\n        return names[0].replace(/[0-9]/g, '');\n      }\n    }\n  }\n  return 'J. Doe';\n}\n\nfunction getAge(patient) {\n  const ageMs = Date.now() - Date.parse(patient.birthDate);\n  return Math.trunc(new Date(ageMs).getUTCFullYear() - 1970);\n}\n\nconst patientAttributeGetters = [\n  ['ID', p => p.id],\n  ['Name', getName],\n  ['Age', getAge],\n  ['Sex', p => p.gender === 'female' ? 'F' : 'M'],\n];\n\nexport default function PatientsPanel(props) {\n  const getters = [...patientAttributeGetters, ...props.extraAttributeGetters];\n  const columns = getters.map(x => x[0]);\n  return (\n    <>\n      <div style={{ fontWeight: 'bold' }} >\n        Patients ({props.patients.length} selected)\n      </div>\n      <span style={{ overflowY: 'scroll' }} >\n        <HTMLTable condensed={true} interactive={true}>\n          <thead>\n            <tr key=\"patientsPanelHeaders\">{columns.slice(1).map(x =>\n              <th key={x}>{x}</th>\n            )}</tr>\n          </thead>\n          <tbody>\n            {getData(props.patients, getters).map(row =>\n              <tr key={`patientsPanelPatient/${row[0]}`}>{row.slice(1).map((col, i) =>\n                <td key={`Patient/${row[0]}/${i}`}>{col}</td>\n              )}</tr>\n            )}\n          </tbody>\n        </HTMLTable>\n      </span>\n    </>\n  );\n}\n","import React from 'react';\nimport 'components/AttributesPanel.css'\nimport { Checkbox, HTMLTable } from '@blueprintjs/core';\n\n// NICE: reveal this panel by clicking a Button.\n\nfunction getConditions(patient) {\n  return ['Asthma', 'Fibromyalgia', 'Cancer'];\n}\n\nfunction getLatestEncounter(patient) {\n  return '2020-08-21';\n}\n\nfunction getLastImmunization(patient) {\n  return '2019-12-26';\n}\n\nfunction getLocation(patient) {\n  return 'Ward 1';\n}\n\nfunction getPCP(patient) {\n  // TODO: implement this\n  return 'Dr. Doe';\n}\n\nconst extraAttributeGetters = [\n  ['Conditions', getConditions],\n  ['Current Location', getLocation],\n  ['Last Immunization', getLastImmunization],\n  ['Latest Encounter', getLatestEncounter],\n  ['PCP', getPCP],\n];\n\n// TODO: decide what the tooltip will contain when hovering over the row.\nexport default function ExtraAttributesPanel(props) {\n  // Applies the changes.\n  function handleAttributeSelected(event, what) {\n    const setColumns = props.setExtraAttributeGetters;\n    if (event.target.checked) {\n      setColumns([...props.extraAttributeGetters, what]);\n    } else {\n      setColumns(props.extraAttributeGetters.filter(x => x[0] !== what[0]));\n    }\n  }\n\n  return (\n    <>\n      <div style={{ fontWeight: 'bold' }} >\n        Extra Attributes\n      </div>\n      <span style={{ overflowY: 'scroll' }} >\n        <HTMLTable condensed={true}>\n          <tbody>\n            {extraAttributeGetters\n              .map(x =>\n                <tr key={x[0]}>\n                  <td>\n                    <Checkbox\n                      onChange={(e) => handleAttributeSelected(e, x)}\n                      checked={props.isChecked}\n                    >\n                      {x[0]}\n                    </Checkbox>\n                  </td>\n                </tr>\n              )\n            }\n          </tbody>\n        </HTMLTable>\n      </span>\n    </>\n  );\n}\n","import React, {useState} from 'react';\nimport HeaderPanel from 'components/HeaderPanel';\nimport ListsPanel from 'components/ListsPanel';\nimport DeveloperPanel from 'components/DeveloperPanel';\nimport PatientsPanel from 'components/PatientsPanel';\nimport ExtraAttributesPanel from 'components/AttributesPanel';\n\nimport './App.css';\nimport \"normalize.css\";\nimport '@blueprintjs/icons/lib/css/blueprint-icons.css';\nimport '@blueprintjs/core/lib/css/blueprint.css';\nimport '@blueprintjs/select/lib/css/blueprint-select.css';\n\n// TODO: update this with the public-facing URL, when it's available.\n//const defaultServerRootURL = \"http://localhost:8080/hapi-fhir-jpaserver/fhir/\";\nconst defaultServerRootURL = 'https://hapi.fhir.org/baseR4/';\nconst defaultTagSystem = 'http://hl7.org/Connectathon'\nconst defaultTagCode = '2020-Sep'\n\nfunction App() {\n  const [developerMessages, setDeveloperMessages] = useState([]);\n  const [extraAttributeGetters, setExtraAttributeGetters] = useState([]);\n  const [patients, setPatients] = useState([]);\n  const [serverRootURL, setServerRootURL] = useState(defaultServerRootURL);\n  const [bearerToken, setBearerToken] = useState('');\n  const [tagSystem, setTagSystem] = useState(defaultTagSystem);\n  const [tagCode, setTagCode] = useState(defaultTagCode);\n\n  React.useEffect(() => {\n    const message = (\n      <pre key={Date.now()}>Updated FHIR Server root to: {serverRootURL}</pre>\n    );\n    setDeveloperMessages(d => [message, ...d]);\n  }, [serverRootURL]);\n\n  return (\n    <div className=\"App\">\n      <div className=\"row\">\n        <div className=\"top\">\n          <HeaderPanel\n            bearerToken={bearerToken}\n            developerMessages={developerMessages}\n            serverRootURL={serverRootURL}\n            setBearerToken={setBearerToken}\n            setDeveloperMessages={setDeveloperMessages}\n            setServerRootURL={setServerRootURL}\n            setTagCode={setTagCode}\n            setTagSystem={setTagSystem}\n            tagCode={tagCode}\n            tagSystem={tagSystem}\n          /></div>\n      </div>\n\n      <div className=\"row\">\n        <div className=\"left\">\n          <ListsPanel\n            bearerToken={bearerToken}\n            developerMessages={developerMessages}\n            serverRootURL={serverRootURL}\n            setDeveloperMessages={setDeveloperMessages}\n            setPatients={setPatients}\n            tagCode={tagCode}\n            tagSystem={tagSystem}\n          />\n        </div>\n        <div className=\"center\">\n          <PatientsPanel\n            bearerToken={bearerToken}\n            extraAttributeGetters={extraAttributeGetters}\n            patients={patients}\n            setDeveloperMessages={setDeveloperMessages}\n          />\n        </div>\n        <div className=\"right\">\n          <ExtraAttributesPanel\n            bearerToken={bearerToken}\n            extraAttributeGetters={extraAttributeGetters}\n            setExtraAttributeGetters={setExtraAttributeGetters}\n          />\n        </div>\n      </div>\n\n      <div className=\"row\">\n        <div className=\"bottom\">\n          <DeveloperPanel\n            developerMessages={developerMessages}\n          />\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\n// Returns a DemoApp either in strict or 'normal' mode.\nfunction DemoApp(props) {\n  if (props.strict) {\n    return (\n      <React.StrictMode>\n        <App />\n      </React.StrictMode>\n    );\n  }\n  return <App />;\n}\n\nReactDOM.render(\n  <DemoApp strict={false} />,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}